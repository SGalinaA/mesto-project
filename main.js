(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{NS:()=>A,Yn:()=>S,z8:()=>g,BU:()=>y,rC:()=>v,Ph:()=>f,Tw:()=>z});var e=document.querySelectorAll(".popup__close");function o(t){t.classList.add("popup_opened"),document.addEventListener("keydown",r)}function n(t){t.classList.remove("popup_opened"),document.removeEventListener("keydown",r)}function r(t){"Escape"===t.key&&n(document.querySelector(".popup_opened"))}document.querySelectorAll(".popup").forEach((function(t){t.addEventListener("click",(function(t){t.target.classList.contains("popup")&&n(t.target)}))})),e.forEach((function(t){var e=t.closest(".popup");t.addEventListener("click",(function(){return n(e)}))}));var c=document.querySelector(".profile__avatar"),a=document.querySelector(".photo-grid__elements"),i=document.querySelector(".cardtemplate").content;function u(t){var e=i.querySelector(".photo-grid__item").cloneNode(!0),n=e.querySelector(".photo-grid__image"),r=e.querySelector(".photo-grid__name"),c=e.querySelector(".photo-grid__like-number");return n.src=t.link,n.alt=t.name,r.textContent=t.name,c.textContent=t.likes.length,e.querySelector(".photo-grid__like").addEventListener("click",(function(e){e.target.classList.contains("photo-grid__like_active")?(function(t,e){fetch("https://nomoreparties.co/v1/plus-cohort-28/cards/likes/".concat(t._id),{method:"DELETE",headers:{authorization:"7ee2f37b-c345-4765-8a16-5dff52a03a30","Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){console.log(t),e.textContent=t.likes.length})).catch((function(t){console.log(t)}))}(t,c),e.target.classList.remove("photo-grid__like_active")):(function(t,e){fetch("https://nomoreparties.co/v1/plus-cohort-28/cards/likes/".concat(t._id),{method:"PUT",headers:{authorization:"7ee2f37b-c345-4765-8a16-5dff52a03a30","Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){console.log(t),e.textContent=t.likes.length})).catch((function(t){console.log(t)}))}(t,c),e.target.classList.add("photo-grid__like_active"))})),e.querySelector(".photo-grid__delete").addEventListener("click",(function(){(function(t){fetch("https://nomoreparties.co/v1/plus-cohort-28/cards/".concat(t._id),{method:"DELETE",headers:{authorization:"7ee2f37b-c345-4765-8a16-5dff52a03a30","Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){console.log(t)})).catch((function(t){console.log(t)}))})(t),e.remove()})),n.addEventListener("click",(function(t){o(S),A(t.target)})),e}fetch("https://nomoreparties.co/v1/plus-cohort-28/cards",{headers:{authorization:"7ee2f37b-c345-4765-8a16-5dff52a03a30"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){t.forEach((function(t){var e=u(t);a.append(e),"eff8e57b11ce4b483cd39a99"!==t.owner._id&&e.querySelector(".photo-grid__delete").classList.remove("photo-grid__delete"),t.likes.length>0&&e.querySelector(".photo-grid__like").classList.add("photo-grid__like_active")}))})).catch((function(t){console.log(t)}));function s(t,e,o){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.removeAttribute("disabled","disabled"),e.classList.remove(o.inactiveButtonClass)):(e.setAttribute("disabled","disabled"),e.classList.add(o.inactiveButtonClass))}var l,p=document.querySelector(".profile__edit-button"),d=document.querySelector(".profile__add-button"),f=document.querySelector(".profile-popup"),h=document.forms["profile-form"],m=h.querySelector(".popup__main-text"),_=h.querySelector('input[name="aboutuser"]'),v=document.querySelector(".profile__name"),y=document.querySelector(".profile__description"),g=document.querySelector(".popup-add"),S=document.querySelector(".popup-photo"),b=document.querySelector(".popup-photo__img"),k=document.querySelector(".popup-photo__caption"),q=document.forms["card-form"],C=q.querySelector(".popup__main-text"),L=q.querySelector('input[name="photolink"]'),E=q.querySelector(".popup__button"),j=document.querySelector(".profile__edit-avatar"),x=document.forms["avatar-form"],P=document.querySelector(".popup-avatar"),T=x.querySelector('input[name="photolink"]');function A(t){var e=t.src;b.src=e;var o=t.alt;k.textContent=o,b.alt=o}function z(t){t.querySelector(".popup__button").textContent="Сохранение..."}fetch("https://nomoreparties.co/v1/plus-cohort-28/users/me ",{headers:{authorization:"7ee2f37b-c345-4765-8a16-5dff52a03a30"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){v.textContent=t.name,y.textContent=t.about,c.src=t.avatar})).catch((function(t){console.log(t)})),p.addEventListener("click",(function(){o(f),m.value=v.textContent,_.value=y.textContent})),d.addEventListener("click",(function(){o(g)})),j.addEventListener("click",(function(){o(P)})),q.addEventListener("submit",(function(t){t.preventDefault();var e=C.value,o=L.value,r={name:e,link:o,likes:[]};!function(t,e){fetch("https://nomoreparties.co/v1/plus-cohort-28/cards",{method:"POST",headers:{authorization:"7ee2f37b-c345-4765-8a16-5dff52a03a30","Content-Type":"application/json"},body:JSON.stringify({name:t,link:e})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){console.log(t),z(g),n(g)})).catch((function(t){console.log(t)}))}(e,o);var c=u(r);a.prepend(c),E.classList.add("popup__button_inactive"),console.log(c),t.target.reset()})),x.addEventListener("submit",(function(t){var e=document.querySelector(".profile__avatar");t.preventDefault(),console.log(T.value),function(t,e,o){fetch("https://nomoreparties.co/v1/plus-cohort-28/users/me/avatar",{method:"PATCH",headers:{authorization:"7ee2f37b-c345-4765-8a16-5dff52a03a30","Content-Type":"application/json"},body:JSON.stringify({avatar:t.value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){console.log(t),z(o),e.src=t.avatar,n(o)})).catch((function(t){console.log(t)}))}(T,e,P),t.target.reset()})),h.addEventListener("submit",(function(t){t.preventDefault();var e=m.value,o=_.value;v.textContent=e,y.textContent=o,function(t,e){fetch("https://nomoreparties.co/v1/plus-cohort-28/users/me",{method:"PATCH",headers:{authorization:"7ee2f37b-c345-4765-8a16-5dff52a03a30","Content-Type":"application/json"},body:JSON.stringify({name:t,about:e})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){console.log(t),z(f),n(f)})).catch((function(t){console.log(t)}))}(e,o)})),l={formSelector:".popup__container",inputSelector:".popup__main-text",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_inactive",inputErrorClass:"popup__main-text_error",errorClass:"popup__error-description"},Array.from(document.querySelectorAll(l.formSelector)).forEach((function(t){!function(t,e){var o=Array.from(t.querySelectorAll(e.inputSelector)),n=t.querySelector(e.submitButtonSelector);s(o,n,e),o.forEach((function(r){r.addEventListener("input",(function(){(function(t,e,o){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?function(t,e,o){var n=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(o.inputErrorClass),n.textContent="",n.classList.remove(o.errorClass)}(t,e,o):function(t,e,o,n){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.add(n.inputErrorClass),console.log(n.inputErrorClass),r.textContent=o,r.classList.add(n.errorClass)}(t,e,e.validationMessage,o)})(t,r,e),s(o,n,e)}))}))}(t,l)}))})();